import{P as q,g as z,r as u,f as k,$ as t,p as v,v as B,y as s,z as a,aR as e,I as x,D as g,A as c,aT as M,L as N,K as P,aq as R,T as m,ap as $}from"./index-21964c78.js";import{E as D,a as A}from"./form-item-8d3c5b0e.js";/* empty css               *//* empty css              */import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";import"./castArray-18b00898.js";import"./_baseClone-42b68cca.js";import"./_Uint8Array-4a48d71f.js";import"./_initCloneObject-dc96d043.js";const L={class:"tab-content"},O=q({__name:"password",setup(j){const{userInfo:w,labelPosition:C}=z(),f=u(!0),p=u(),y=u(60),i=u();let h=u(!1);w.user_mobile&&(h.value=!0);const I=u("default"),V=u();u("");let l=k({mobile:w.user_mobile,password:"",auth_code:"",user_intl:"+86"});const E=k({mobile:[{required:!0,message:t("请输入手机号"),trigger:"blur"}],password:[{required:!0,message:t("请输入密码"),trigger:"change"}],auth_code:[{type:"date",required:!0,message:t("请输入验证码"),trigger:"change"}]}),F=()=>{let r={mobile:"+86"+l.mobile,password:l.password,auth_code:l.auth_code,user_intl:"+86",mobile_id:"pc"};R(r).then(o=>{o.status==200?m.success(t("密码修改成功")):m.error(o.msg)})},S=async r=>{r&&await r.validate((o,d)=>{o?(console.log("submit!"),F()):console.log("error submit!",d)})};let T=()=>{if(!l.mobile){m.error("请输入手机号");return}$({mobile:l.mobile}).then(r=>{r.status==200?(p.value||(i.value=y.value,f.value=!1,p.value=setInterval(()=>{i.value>0&&i.value<=y.value?(i.value--,console.log("count----",i)):(f.value=!0,clearInterval(p.value),p.value=null)},1e3)),m.success("验证码已经发生成功，请尽快输入验证码!")):m.error(r.msg)})};return(r,o)=>{const d=N,_=D,b=P,U=A;return v(),B("div",L,[s(U,{ref_key:"ruleFormRef",ref:V,model:e(l),rules:e(E),"label-width":"160px","label-position":e(C),onSubmit:o[4]||(o[4]=M(()=>{},["prevent"])),size:e(I)},{default:a(()=>[s(_,{label:e(t)("手机号"),prop:"mobile"},{default:a(()=>[s(d,{disabled:e(h),modelValue:e(l).mobile,"onUpdate:modelValue":o[0]||(o[0]=n=>e(l).mobile=n)},null,8,["disabled","modelValue"])]),_:1},8,["label"]),s(_,{label:e(t)("新密码"),prop:"password"},{default:a(()=>[s(d,{modelValue:e(l).password,"onUpdate:modelValue":o[1]||(o[1]=n=>e(l).password=n)},null,8,["modelValue"])]),_:1},8,["label"]),s(_,{label:e(t)("验证码")},{default:a(()=>[s(d,{modelValue:e(l).auth_code,"onUpdate:modelValue":o[2]||(o[2]=n=>e(l).auth_code=n),prop:"auth_code",placeholder:""},{append:a(()=>[e(f)?(v(),x(b,{key:0,style:{padding:"0",width:"102px"},onClick:e(T)},{default:a(()=>[g(c(e(t)("获取验证码")),1)]),_:1},8,["onClick"])):(v(),x(b,{key:1,style:{padding:"0",width:"102px"}},{default:a(()=>[g(c(e(i))+" s "+c(e(t)("后获取")),1)]),_:1}))]),_:1},8,["modelValue"])]),_:1},8,["label"]),s(_,null,{default:a(()=>[s(b,{type:"primary","native-type":"submit",onClick:o[3]||(o[3]=n=>S(e(V)))},{default:a(()=>[g(c(e(t)("确认修改")),1)]),_:1})]),_:1})]),_:1},8,["model","rules","label-position","size"])])}}});const oe=K(O,[["__scopeId","data-v-17260964"]]);export{oe as default};
