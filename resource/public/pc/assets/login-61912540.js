import{P as H,r as m,N as j,g as z,u as X,e as Y,f as E,$ as s,w as Z,dK as ee,i as te,n as oe,p as _,v as g,x as i,aR as e,y as l,z as a,A as c,D as h,F as I,I as D,E as U,aT as le,T as y,ap as se,au as re,L as ae,K as ne,J as ie,e2 as ue,V as de,W as pe,e3 as ce}from"./index-21964c78.js";import{E as _e,a as me}from"./form-item-8d3c5b0e.js";/* empty css             */import{E as fe}from"./image-viewer-dd6920ac.js";/* empty css               */import{_ as ge}from"./Verify-05ba80f2.js";/* empty css              */import"./tag-b8b29d1f.js";import{a as ye,E as ve}from"./select-ed2293fb.js";import"./scrollbar-c1d26490.js";import"./popper-251c4401.js";import{_ as he}from"./_plugin-vue_export-helper-c27b6911.js";import"./castArray-18b00898.js";import"./_baseClone-42b68cca.js";import"./_Uint8Array-4a48d71f.js";import"./_initCloneObject-dc96d043.js";import"./debounce-6ea0a711.js";import"./strings-b80b2625.js";import"./isEqual-3f4e7b62.js";import"./_baseIteratee-8f2ec951.js";import"./hasIn-54cf4aec.js";import"./index-a2bc563c.js";import"./isUndefined-aa0326a0.js";const W=b=>(de("data-v-a2c70340"),b=b(),pe(),b),be={class:"login-container login"},we={class:"square"},xe={class:"leftSquare"},ke=["src"],Ve={class:"rightSquare"},Ce=W(()=>i("div",{class:"errors-container"},null,-1)),Ee={class:"login-header"},Ie={href:"javascript:void(0)",class:"logo"},Ue={style:{"margin-left":"65px"}},Se={class:"text-left"},qe={key:3,class:"text-left",style:{"margin-top":"10px"}},Fe={class:"login-footer hidden"},Me={class:"external-login-small",style:{"margin-right":"20px"}},Ne=W(()=>i("i",{class:"fa-wechat",style:{"margin-top":"5px"}},null,-1)),Re=[Ne],$e=H({__name:"login",setup(b){m("");const S=m();j.tokenName;const q=z(),k=X();Y();const F=z(),A=m(""),V=m(!0),w=m(),M=m(60),v=m(),K=Math.random(),O=n=>F.login(n),t=E({user_account:"",user_mobile:"",username:"",user_password:"",verify_code:"",user_intl:"+86",bind_type:2,is_verify:!1}),N=n=>{t.is_verify=n},J=E({user_account:[{required:!0,message:s("请输入账号"),trigger:"blur"}],user_mobile:[{required:!0,message:s("请输入手机号"),trigger:"blur"}],user_password:[{required:!0,message:s("请输入密码"),trigger:"change"}],verify_code:[{required:!0,message:s("请输入验证码"),trigger:"change"}]});E({});let R=m(""),$=()=>{ce().then(n=>{n.status==200?window.location.href=n.data:y.error(n.msg)})},C=()=>{let n={};if(t.bind_type==1){if(!t.is_verify){y.error(s("请拖动滑块完成验证"));return}if(!t.user_mobile){y.error(s("请输入手机号"));return}n.mobile=t.user_intl+t.user_mobile,se(n).then(o=>{o.status==200?(y.success(s("验证码已经发送成功，请尽快输入验证码!")),w.value||(v.value=M.value,V.value=!1,w.value=setInterval(()=>{v.value>0&&v.value<=M.value?(v.value--,console.log("count----",v)):(V.value=!0,clearInterval(w.value),w.value=null)},1e3))):y.error(o.msg)})}else re({verify_key:K}).then(o=>{if(o){console.log(o);let d=new FileReader;d.onload=function(u){R.value=u.target.result},d.readAsDataURL(o)}})};const P=n=>{n&&n.validate(async o=>{if(o)try{let d={verify_code:t.verify_code};if(t.bind_type==1)d.user_mobile=t.user_intl+t.user_mobile,d.verify_key=t.user_intl+t.user_mobile;else{let u=t.user_account;if(t.bind_type==2){if(!t.is_verify){y.error(s("请拖动滑块完成验证"));return}u=t.user_intl+u}d.username=u,d.user_account=u,d.password=t.user_password}await O(d).then(async u=>{k.go(-1)}).catch(u=>{console.error(u),y.error(u.msg)})}finally{}else return console.log("error submit!"),!1})};return Z(()=>{}),ee({config_key:"account_login_bg"}).then(n=>{n.status==200&&(A.value=n.data[0].config_value)}),te(()=>{C();const n=k.currentRoute.value.query.ukey;if(n){let o={user_nickname:"",user_avatar:""};F.afterLogin(n,j.tokenName,o)}q.hasLogin&&k.push({path:"/index"})}),(n,o)=>{const d=oe("router-link"),u=ye,B=ve,f=ae,p=_e,L=ge,x=ne,Q=fe,T=ie,G=me;return _(),g("div",null,[i("div",be,[i("div",we,[i("div",xe,[i("img",{src:e(q).info.account_login_bg,style:{"border-radius":"10px 0px 0px 10px"}},null,8,ke)]),i("div",Ve,[Ce,l(G,{class:"login-form",ref_key:"ruleFormRef",ref:S,model:e(t),rules:e(J),"label-width":"69px","label-position":"left",onSubmit:o[14]||(o[14]=le(()=>{},["prevent"]))},{default:a(()=>[i("div",Ee,[i("a",Ie,[i("span",null,c(e(s)("账号登录")),1),i("span",Ue,[l(d,{to:{path:"/login/register"}},{default:a(()=>[h(c(e(s)("新用户注册")),1)]),_:1})])])]),e(t).bind_type==2?(_(),g(I,{key:0},[l(p,{label:e(s)(""),prop:"user_account"},{default:a(()=>[l(f,{modelValue:e(t).user_account,"onUpdate:modelValue":o[1]||(o[1]=r=>e(t).user_account=r),modelModifiers:{number:!0},placeholder:e(s)("请输入手机号"),class:"input-with-select"},{prepend:a(()=>[l(B,{modelValue:e(t).user_intl,"onUpdate:modelValue":o[0]||(o[0]=r=>e(t).user_intl=r),placeholder:"Select",class:"user_intl"},{default:a(()=>[l(u,{label:"+86",value:"+86",style:{height:"45px"}})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,null,{default:a(()=>[l(L,{onUpdate:N,handlerWidth:"74"})]),_:1}),l(p,{label:e(s)(""),prop:"user_password"},{default:a(()=>[l(f,{modelValue:e(t).user_password,"onUpdate:modelValue":o[2]||(o[2]=r=>e(t).user_password=r),autocomplete:"new-password",type:"password",placeholder:e(s)("请输入密码"),class:"input-with-select"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])],64)):e(t).bind_type==1?(_(),g(I,{key:1},[l(p,{label:e(s)(""),prop:"user_mobile"},{default:a(()=>[l(f,{modelValue:e(t).user_mobile,"onUpdate:modelValue":o[4]||(o[4]=r=>e(t).user_mobile=r),modelModifiers:{number:!0},placeholder:e(s)("请输入手机号"),class:"input-with-select"},{prepend:a(()=>[l(B,{modelValue:e(t).user_intl,"onUpdate:modelValue":o[3]||(o[3]=r=>e(t).user_intl=r),placeholder:"Select",class:"user_intl"},{default:a(()=>[l(u,{label:"+86",value:"+86",style:{height:"45px"}})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,null,{default:a(()=>[l(L,{onUpdate:N,handlerWidth:"74"})]),_:1}),l(p,{class:"verify-code",label:e(s)(""),prop:"verify_code"},{default:a(()=>[l(f,{style:{width:"291px","font-size":"16px",height:"45px","margin-right":"8px"},modelValue:e(t).verify_code,"onUpdate:modelValue":o[5]||(o[5]=r=>e(t).verify_code=r),autocomplete:"new-password",placeholder:e(s)("验证码")},null,8,["modelValue","placeholder"]),e(V)?(_(),D(x,{key:0,type:"primary",class:"send-code",onClick:e(C)},{default:a(()=>[h(c(e(s)("发送验证码")),1)]),_:1},8,["onClick"])):(_(),D(x,{key:1,style:{padding:"0",width:"102px"}},{default:a(()=>[h(c(e(v))+" s "+c(e(s)("后获取")),1)]),_:1}))]),_:1},8,["label"])],64)):(_(),g(I,{key:2},[l(p,{label:e(s)(""),prop:"user_account"},{default:a(()=>[l(f,{modelValue:e(t).user_account,"onUpdate:modelValue":o[6]||(o[6]=r=>e(t).user_account=r),autocomplete:"off",class:"input-with-select",placeholder:e(s)("请输入账号")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,{label:e(s)(""),prop:"user_password"},{default:a(()=>[l(f,{modelValue:e(t).user_password,"onUpdate:modelValue":o[7]||(o[7]=r=>e(t).user_password=r),autocomplete:"new-password",type:"password",placeholder:e(s)("请输入密码"),class:"input-with-select"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,{label:e(s)(""),prop:"verify_code"},{default:a(()=>[l(f,{style:{overflow:"hidden"},modelValue:e(t).verify_code,"onUpdate:modelValue":o[8]||(o[8]=r=>e(t).verify_code=r),placeholder:e(s)("验证码"),class:"input-with-select"},{append:a(()=>[l(x,{style:{padding:"0",width:"102px",display:"inherit","background-color":"unset !important"},onClick:e(C)},{default:a(()=>[l(Q,{class:"img-responsive",style:{height:"41px"},src:e(R)},null,8,["src"])]),_:1},8,["onClick"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])],64)),l(p,null,{default:a(()=>[l(x,{type:"primary",size:"large",style:{width:"409px",height:"45px","font-size":"21px"},"native-type":"submit",onClick:o[9]||(o[9]=r=>P(e(S)))},{default:a(()=>[h(c(e(s)("登录")),1)]),_:1})]),_:1}),i("div",Se,[e(t).bind_type!=2?(_(),g("a",{key:0,href:"javascript:void(0)",class:"mobile",onClick:o[10]||(o[10]=r=>e(t).bind_type=2)},[l(T),h(c(e(s)("手机密码登录")),1)])):U("",!0),e(t).bind_type!=0?(_(),g("a",{key:1,href:"javascript:void(0)",class:"mobile",style:{"margin-left":"65px"},onClick:o[11]||(o[11]=r=>e(t).bind_type=0)},c(e(s)("账号登录")),1)):U("",!0)]),l(d,{style:{"margin-right":"60px",float:"right","margin-top":"-25px"},to:{path:"/login/findpwd"}},{default:a(()=>[h(c(e(s)("忘记密码？")),1)]),_:1}),e(t).bind_type!=1?(_(),g("div",qe,[i("a",{href:"javascript:void(0)",style:{"margin-left":"70px"},onClick:o[12]||(o[12]=r=>e(t).bind_type=1)},[l(T,{class:"location"},{default:a(()=>[l(e(ue))]),_:1})])])):U("",!0),i("div",Fe,[i("span",Me,c(e(s)("其他账号登录")),1),i("span",{class:"wechat external-login-small",onClick:o[13]||(o[13]=(...r)=>e($)&&e($)(...r))},Re)])]),_:1},8,["model","rules"])])])])])}}});const rt=he($e,[["__scopeId","data-v-a2c70340"]]);export{rt as default};
