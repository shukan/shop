import{P as _,r as F,f as V,g as E,$ as c,i as A,t as R,T as m,ap as D,aq as I,ar as U,p as h,v as z,I as y,z as o,E as M,y as u,D as g,A as d,L as S,K as N}from"./index-21964c78.js";import{a as T,E as q}from"./form-item-8d3c5b0e.js";/* empty css               *//* empty css              */import"./tag-b8b29d1f.js";import{a as O,E as P}from"./select-ed2293fb.js";import"./scrollbar-c1d26490.js";import"./popper-251c4401.js";import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";import"./castArray-18b00898.js";import"./_baseClone-42b68cca.js";import"./_Uint8Array-4a48d71f.js";import"./_initCloneObject-dc96d043.js";import"./strings-b80b2625.js";import"./isEqual-3f4e7b62.js";import"./debounce-6ea0a711.js";import"./_baseIteratee-8f2ec951.js";import"./hasIn-54cf4aec.js";import"./index-a2bc563c.js";import"./isUndefined-aa0326a0.js";const L=_({setup(){const e=F();let l=V({userRows:{}});const{userInfo:k}=E();l.userRows=k,console.log(l.userRows);const a=V({mobile:l.userRows.user_mobile,auth_code:"",user_intl:"+86"});let B=F(1);const w=V({mobile:[{required:!0,message:c("请输入手机号"),trigger:"blur"}],auth_code:[{required:!0,message:c("请输入验证码"),trigger:"blur"}]});F("");const p=F(!0),s=F(),f=F(60),t=F();let i=()=>{let n={};if(!a.mobile){m.error(c("请输入手机号"));return}n.mobile=a.user_intl+a.mobile,D(n).then(v=>{v.status==200?(s.value||(t.value=f.value,p.value=!1,s.value=setInterval(()=>{t.value>0&&t.value<=f.value?(t.value--,console.log("count----",t)):(p.value=!0,clearInterval(s.value),s.value=null)},1e3)),m.success(c("验证码已经发送成功，请尽快输入验证码!"))):m.error(v.msg)})};const C=n=>{n&&n.validate(v=>{if(v){if(a.mobile==l.userRows.user_mobile){m.error(c("你已经绑定过该手机！"));return}let $={verify_code:a.auth_code,verify_key:a.user_intl+a.mobile};I($).then(b=>{b.status==200?m.success(c("手机号绑定成功!")):m.error(b.msg)}).catch(b=>{m.error(b.msg)})}else return console.log("error submit!"),!1})},r=n=>{n&&n.validate(v=>{if(v){console.log("submit!");var $={code:a.auth_code};U($).then(b=>{b.status==200?(clearInterval(s.value),a.mobile="",a.auth_code="",a.user_intl="+86",p.value=!0,t.value="",B.value=1):m.error(b.msg)})}else return console.log("error submit!"),!1})};return A(()=>{}),{...R(l),ruleFormRef:e,ruleForm:a,rules:w,count:t,ishow:p,type:B,submitForm:C,getCode:i,rebind:r}}}),j={class:"account-container"};function G(e,l,k,a,B,w){const p=O,s=P,f=S,t=q,i=N,C=T;return h(),z("div",j,[e.type==1?(h(),y(C,{key:0,ref:"ruleFormRef",rules:e.rules,model:e.ruleForm,"label-position":"left","label-width":"120px"},{default:o(()=>[u(t,{label:e.$t("手机号"),prop:"mobile"},{default:o(()=>[u(f,{modelValue:e.ruleForm.mobile,"onUpdate:modelValue":l[1]||(l[1]=r=>e.ruleForm.mobile=r),class:"input-style",placeholder:e.$t("请输入手机号")},{prepend:o(()=>[u(s,{modelValue:e.ruleForm.user_intl,"onUpdate:modelValue":l[0]||(l[0]=r=>e.ruleForm.user_intl=r),placeholder:"Select",style:{width:"90px"}},{default:o(()=>[u(p,{label:"+86",value:"+86"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(t,{label:e.$t("验证码"),prop:"auth_code"},{default:o(()=>[u(f,{modelValue:e.ruleForm.auth_code,"onUpdate:modelValue":l[2]||(l[2]=r=>e.ruleForm.auth_code=r),placeholder:e.$t("请输入验证码"),class:"input-style"},{append:o(()=>[e.ishow?(h(),y(i,{key:0,style:{padding:"0",height:"45px","min-width":"102px","font-size":"14px",color:"#fff","border-bottom-left-radius":"0","border-top-left-radius":"0"},onClick:e.getCode},{default:o(()=>[g(d(e.$t("获取验证码")),1)]),_:1},8,["onClick"])):(h(),y(i,{key:1,style:{padding:"0","min-width":"102px","font-size":"14px",color:"#fff",height:"45px"}},{default:o(()=>[g(d(e.count)+" s "+d(e.$t("后获取")),1)]),_:1}))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(t,null,{default:o(()=>[u(i,{type:"primary",onClick:l[3]||(l[3]=r=>e.submitForm(e.ruleFormRef))},{default:o(()=>[g(d(e.$t("确认绑定")),1)]),_:1})]),_:1})]),_:1},8,["rules","model"])):e.type==2?(h(),y(C,{key:1,ref:"ruleFormRef",rules:e.rules,model:e.ruleForm,"label-position":"left","label-width":"120px"},{default:o(()=>[u(t,{label:e.$t("手机号"),prop:"mobile"},{default:o(()=>[u(f,{modelValue:e.ruleForm.mobile,"onUpdate:modelValue":l[5]||(l[5]=r=>e.ruleForm.mobile=r),class:"input-style",placeholder:e.$t("请输入手机号"),disabled:"true"},{prepend:o(()=>[u(s,{modelValue:e.ruleForm.user_intl,"onUpdate:modelValue":l[4]||(l[4]=r=>e.ruleForm.user_intl=r),placeholder:"Select",style:{width:"90px"}},{default:o(()=>[u(p,{label:"+86",value:"+86"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(t,{label:e.$t("验证码"),prop:"auth_code"},{default:o(()=>[u(f,{modelValue:e.ruleForm.auth_code,"onUpdate:modelValue":l[6]||(l[6]=r=>e.ruleForm.auth_code=r),placeholder:e.$t("请输入验证码"),class:"input-style"},{append:o(()=>[e.ishow?(h(),y(i,{key:0,style:{padding:"0",height:"45px","min-width":"102px","font-size":"14px",color:"#fff"},onClick:e.getCode},{default:o(()=>[g(d(e.$t("获取验证码")),1)]),_:1},8,["onClick"])):(h(),y(i,{key:1,style:{padding:"0","min-width":"102px","font-size":"14px",color:"#fff",height:"45px"}},{default:o(()=>[g(d(e.count)+" s "+d(e.$t("后获取")),1)]),_:1}))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(t,null,{default:o(()=>[u(i,{type:"primary",onClick:l[7]||(l[7]=r=>e.rebind(e.ruleFormRef))},{default:o(()=>[g(d(e.$t("重新绑定")),1)]),_:1})]),_:1})]),_:1},8,["rules","model"])):M("",!0)])}const pe=K(L,[["render",G]]);export{pe as default};
