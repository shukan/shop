import{P as T,s as U,g as I,f as y,r as L,$ as c,i as P,t as R,dF as A,T as E,a6 as B,dX as N,dY as q,dI as H,n as j,p as _,v as w,x as a,A as r,y as l,z as n,O as J,I as D,L as K,E as z,D as f,aT as O,V as W,W as X,J as Y,K as G}from"./index-21964c78.js";import{v as Q}from"./loading-9a2abf10.js";import{E as Z}from"./overlay-b290a267.js";import{E as x,a as ee}from"./form-item-8d3c5b0e.js";import{E as se}from"./pagination-85e496af.js";/* empty css              */import"./tag-b8b29d1f.js";import"./select-ed2293fb.js";import"./scrollbar-c1d26490.js";import"./popper-251c4401.js";import{E as te,a as ae}from"./table-column-af2cc573.js";import"./checkbox-85319853.js";/* empty css                *//* empty css               *//* empty css             */import{_ as oe}from"./_plugin-vue_export-helper-c27b6911.js";import"./refs-1278d799.js";import"./isUndefined-aa0326a0.js";import"./castArray-18b00898.js";import"./_baseClone-42b68cca.js";import"./_Uint8Array-4a48d71f.js";import"./_initCloneObject-dc96d043.js";import"./isEqual-3f4e7b62.js";import"./strings-b80b2625.js";import"./debounce-6ea0a711.js";import"./_baseIteratee-8f2ec951.js";import"./hasIn-54cf4aec.js";import"./index-a2bc563c.js";import"./flatten-3a6a3668.js";const le=T({components:{Search:U},setup(){const e=I();let s=y({messageLists:[],page:1,size:30,total:1,loading:!0,dialogVisible:!1,user_nickname:""});const C=L();let b=y({user_nickname:"",message_content:""});const V=(i,o,m)=>{m()},F=y({user_nickname:[{required:!0,message:c("请输入接收人昵称"),trigger:"blur"},{validator:V,trigger:"blur"}],message_content:[{required:!0,message:c("请输入短消息内容"),trigger:"blur"}]}),d=()=>{let i={page:s.page,size:s.size};s.user_nickname&&(i.user_nickname=s.user_nickname),A(i).then(o=>{o.status==200?(s.messageLists=o.data.items,s.total=o.data.records,s.loading=!1):E.error(o.msg),s.loading=!1})},v=(i,o)=>{b.user_nickname=o.user_other_nickname,s.dialogVisible=!0},p=(i,o)=>{B.confirm(c("确定要删除吗?"),{confirmButtonText:c("确定"),cancelButtonText:c("取消"),center:!0}).then(()=>{let m={message_id:o.message_id};N(m).then(h=>{h.status==200?d():E.error(h.msg),s.loading=!1})})},g=()=>{H(b).then(o=>{o.status==200?(s.dialogVisible=!1,s.loading=!1,d()):E.error(o.msg),s.loading=!1})},u=i=>{i&&i.validate(o=>{if(o)console.log("submit!"),g();else return console.log("error submit!"),!1})},k=i=>{q({message_id:i}).then(o=>{o.status&&B.alert(o.data.message_content,"",{cancelButtonText:"Cancel",center:!0,callback:m=>{d()}})})};return P(()=>{d()}),{getMessage:d,handleReply:v,handleDelete:p,submitForm:u,read:k,form:b,ruleFormRef:C,rules:F,counter:e,...R(s)}}});const $=e=>(W("data-v-da650f23"),e=e(),X(),e),ne={class:"tab-content pd0 pt20"},ie={class:"animation-slide-left tab-message active",id:"account_content"},re={class:"row form-inline"},de={class:"col-sm-3"},ue={class:"vertical-top",style:{display:"inline-block"}},me=$(()=>a("i",{class:"fa-pencil"},null,-1)),pe={class:"col-sm-9"},ge={class:"vertical-top pull-right"},ce={class:"btn btn-gray btn-icon btn-icon-standalone hide",id:"msg_remove_btn"},_e=$(()=>a("i",{class:"fa-trash"},null,-1)),fe={class:"mailbox-env"},be={key:0,class:"label label-danger"},he={key:1,class:"label label-success"},ve=["onClick","innerHTML"],ke={class:"sortPagiBar"},ye={class:"bottom-pagination"},Ee={class:"manage-edit-box mail-compose",id:"compose-mail",style:{width:"600px"}},we={class:"mail-header",style:{"padding-left":"20px"}},$e=$(()=>a("i",{class:"fa fa-pencil"},null,-1)),Ce={class:"box-main"};function Ve(e,s,C,b,V,F){const d=j("Search"),v=Y,p=G,g=K,u=ae,k=te,i=se,o=x,m=ee,h=Z,S=Q;return _(),w("div",ne,[a("div",ie,[a("div",re,[a("div",de,[a("div",ue,[a("button",{class:"btn btn-primary btn-icon btn-icon-standalone",onClick:s[0]||(s[0]=()=>{e.dialogVisible=!0})},[me,a("span",null,r(e.$t("写短信")),1)])])]),a("div",pe,[a("div",ge,[l(g,{modelValue:e.user_nickname,"onUpdate:modelValue":s[1]||(s[1]=t=>e.user_nickname=t),type:"search",class:"w-50 m-2",size:"large",placeholder:e.$t("用户昵称")},{append:n(()=>[l(p,{size:"small",onClick:e.getMessage},{default:n(()=>[l(v,{size:30,color:"#333"},{default:n(()=>[l(d)]),_:1})]),_:1},8,["onClick"])]),_:1},8,["modelValue","placeholder"]),a("button",ce,[_e,a("span",null,r(e.$t("删除")),1)])])])]),a("section",fe,[J((_(),D(k,{ref:"multipleTableRef",data:e.messageLists,style:{width:"100%"},onSelectionChange:e.handleSelectionChange},{default:n(()=>[l(u,{type:"selection",width:"55"}),l(u,{label:e.$t("用户"),width:"150"},{default:n(t=>[t.row.message_type==1?(_(),w("span",be,r(e.$t("系统")),1)):z("",!0),t.row.message_is_read?z("",!0):(_(),w("span",he,r(e.$t("未读")),1)),f(" "+r(t.row.user_other_nickname),1)]),_:1},8,["label"]),l(u,{property:"message_content",label:e.$t("消息"),width:"250"},{default:n(t=>[a("span",{style:{cursor:"pointer"},onClick:M=>e.read(t.row.message_id),innerHTML:t.row.message_content},null,8,ve)]),_:1},8,["label"]),l(u,{property:"message_time",label:e.$t("时间"),"show-overflow-tooltip":""},{default:n(t=>[f(r(new Date(parseInt(t.row.message_time)).toLocaleString().replace(/年|月/g,"-").replace(/日/g," ")),1)]),_:1},8,["label"]),l(u,{label:e.$t("操作"),width:"200"},{default:n(t=>[l(p,{size:"small",onClick:M=>e.handleReply(t.$index,t.row)},{default:n(()=>[f(r(e.$t("回复")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange"])),[[S,e.loading]])])]),a("div",ke,[a("div",ye,[a("nav",null,[(_(),D(i,{currentPage:e.page,"onUpdate:currentPage":s[2]||(s[2]=t=>e.page=t),"page-size":e.size,"onUpdate:pageSize":s[3]||(s[3]=t=>e.size=t),"page-sizes":[30,60,90,120],small:!1,disabled:!1,background:!0,layout:"prev,pager,next,total,jumper",total:e.total,key:e.page,onSizeChange:s[4]||(s[4]=t=>{e.size=t,e.getMessage()}),onCurrentChange:s[5]||(s[5]=t=>{e.page=t,e.getMessage()})},null,8,["currentPage","page-size","total"]))])])]),l(h,{modelValue:e.dialogVisible,"onUpdate:modelValue":s[10]||(s[10]=t=>e.dialogVisible=t),width:"700px",draggable:""},{default:n(()=>[a("div",Ee,[a("div",we,[a("h3",null,[$e,f(" "+r(e.$t("写短信")),1)])]),a("div",Ce,[l(m,{model:e.form,ref:"ruleFormRef","label-position":e.counter.labelPosition,onSubmit:s[9]||(s[9]=O(()=>{},["prevent"])),rules:e.rules,"label-width":"120px"},{default:n(()=>[l(o,{label:e.$t("短消息接收人"),prop:"user_nickname"},{default:n(()=>[l(g,{modelValue:e.form.user_nickname,"onUpdate:modelValue":s[6]||(s[6]=t=>e.form.user_nickname=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(o,{label:e.$t("短消息内容"),prop:"message_content"},{default:n(()=>[l(g,{modelValue:e.form.message_content,"onUpdate:modelValue":s[7]||(s[7]=t=>e.form.message_content=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(o,null,{default:n(()=>[l(p,{type:"primary","native-type":"submit",onClick:s[8]||(s[8]=t=>e.submitForm(e.ruleFormRef))},{default:n(()=>[f(r(e.$t("确定")),1)]),_:1})]),_:1})]),_:1},8,["model","label-position","rules"])])])]),_:1},8,["modelValue"])])}const ts=oe(le,[["render",Ve],["__scopeId","data-v-da650f23"]]);export{ts as default};
